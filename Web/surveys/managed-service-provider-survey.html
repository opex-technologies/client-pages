<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managed Service Provider Survey - Capabilities Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, Helvetica, sans-serif;
            line-height: 1.6;
            color: #1a2859;
            background: linear-gradient(135deg, #ffffff 0%, #a8c5e7 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(26, 40, 89, 0.15);
            overflow: hidden;
        }
        
        .header {
            background: #ffffff;
            color: #1a2859;
            padding: 30px 40px;
            text-align: center;
            border-bottom: 3px solid #00c4cc;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header-logo {
            position: absolute;
            left: 40px;
            top: 50%;
            transform: translateY(-50%);
            height: 60px;
            width: auto;
        }
        
        .header-content {
            flex: 1;
        }
        
        .header h1 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.3px;
        }
        
        .header p {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .form-container {
            padding: 40px;
        }
        
        .progress-bar {
            background: rgba(168, 197, 231, 0.3);
            height: 6px;
            border-radius: 3px;
            margin-bottom: 40px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #00c4cc 0%, #01c1f3 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }
        
        .section {
            margin-bottom: 48px;
            padding: 32px;
            border: 1px solid rgba(168, 197, 231, 0.3);
            border-radius: 16px;
            background: linear-gradient(135deg, #ffffff 0%, rgba(168, 197, 231, 0.05) 100%);
            transition: all 0.3s ease;
        }
        
        .section:hover {
            border-color: rgba(112, 218, 205, 0.4);
            box-shadow: 0 4px 20px rgba(26, 40, 89, 0.08);
            transform: translateY(-2px);
        }
        
        .section h3 {
            color: #1a2859;
            margin-bottom: 32px;
            font-size: 1.4rem;
            font-weight: 700;
            padding-bottom: 16px;
            border-bottom: 3px solid #00c4cc;
            position: relative;
            letter-spacing: -0.02em;
        }
        
        .section h3::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 60px;
            height: 3px;
            background: #70dacd;
            border-radius: 3px;
        }
        
        .form-group {
            margin-bottom: 32px;
            padding: 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(168, 197, 231, 0.2);
            transition: all 0.2s ease;
        }
        
        .form-group:hover {
            background: rgba(255, 255, 255, 0.9);
            border-color: rgba(112, 218, 205, 0.3);
        }
        
        .form-group:focus-within {
            background: rgba(255, 255, 255, 1);
            border-color: #00c4cc;
            box-shadow: 0 0 0 3px rgba(0, 196, 204, 0.1);
        }
        
        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: #0d1a3d;
            font-size: 1rem;
            line-height: 1.5;
            letter-spacing: -0.01em;
        }
        
        .form-group .question-category {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(135deg, #70dacd 0%, #01c1f3 100%);
            color: #0d1a3d;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 12px;
            letter-spacing: 0.02em;
            text-transform: uppercase;
            box-shadow: 0 2px 8px rgba(112, 218, 205, 0.3);
        }
        
        .form-group .question-category::before {
            content: '•';
            margin-right: 6px;
            font-size: 1.2em;
        }
        
        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 12px 16px;
            border: 2px solid rgba(168, 197, 231, 0.3);
            border-radius: 8px;
            background: #ffffff;
            transition: all 0.3s ease;
            margin-bottom: 0;
            position: relative;
            overflow: hidden;
        }
        
        .radio-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(112, 218, 205, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .radio-option:hover {
            background: linear-gradient(135deg, rgba(112, 218, 205, 0.08) 0%, #ffffff 100%);
            border-color: #70dacd;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(112, 218, 205, 0.2);
        }
        
        .radio-option:hover::before {
            left: 100%;
        }
        
        .radio-option input[type="radio"] {
            width: auto;
            margin-right: 8px;
            margin-bottom: 0;
            padding: 0;
        }
        
        .radio-option input[type="radio"]:checked + .radio-label {
            font-weight: 600;
            color: #1a2859;
        }
        
        .radio-option:has(input[type="radio"]:checked) {
            background: linear-gradient(135deg, rgba(0, 196, 204, 0.15) 0%, #ffffff 100%);
            border-color: #00c4cc;
            box-shadow: 0 4px 16px rgba(0, 196, 204, 0.25);
            transform: scale(1.02);
        }
        
        .radio-option:has(input[type="radio"]:checked)::after {
            content: '✓';
            position: absolute;
            top: 4px;
            right: 8px;
            color: #00c4cc;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .radio-label {
            font-size: 0.9rem;
            color: #0d1a3d;
            cursor: pointer;
            font-weight: 500;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(168, 197, 231, 0.4);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #fff;
            font-weight: 400;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #00c4cc;
            box-shadow: 0 0 0 4px rgba(0, 196, 204, 0.15), 0 4px 12px rgba(0, 196, 204, 0.1);
            transform: translateY(-1px);
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }
        
        .contact-section {
            background: linear-gradient(135deg, #ffffff 0%, rgba(112, 218, 205, 0.1) 100%);
            border: 1px solid #70dacd;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .submit-section {
            margin-top: 48px;
            padding-top: 32px;
            border-top: 2px solid rgba(168, 197, 231, 0.2);
            text-align: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(168, 197, 231, 0.05) 100%);
            border-radius: 16px;
            padding: 32px;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #00c4cc 0%, #01c1f3 100%);
            color: white;
            padding: 18px 48px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
            box-shadow: 0 8px 24px rgba(0, 196, 204, 0.3);
            letter-spacing: 0.02em;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .submit-btn:hover {
            background: linear-gradient(135deg, #01c1f3 0%, #70dacd 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(0, 196, 204, 0.4);
        }
        
        .submit-btn:hover::before {
            left: 100%;
        }
        
        .submit-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0, 196, 204, 0.3);
        }
        
        .submit-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px 20px;
            border-radius: 6px;
            font-weight: 500;
            display: none;
            font-size: 1rem;
            text-align: center;
            animation: slideIn 0.3s ease;
        }
        
        .success { 
            background: linear-gradient(135deg, #70dacd 0%, #ffffff 100%); 
            color: #1a2859;
            border: 2px solid #70dacd;
        }
        
        .error { 
            background: linear-gradient(135deg, #eed91a 0%, #ffffff 100%); 
            color: #1a2859;
            border: 2px solid #eed91a;
        }
        
        .footer {
            background: linear-gradient(135deg, #1a2859 0%, #00c4cc 100%);
            color: white;
            padding: 25px 40px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .footer a {
            color: #70dacd;
            text-decoration: none;
        }
        
        .footer a:hover {
            color: white;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Focus indicators for keyboard navigation */
        .form-group:focus-within .question-category {
            outline: 2px solid #00c4cc;
            outline-offset: 2px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 0 16px;
                border-radius: 8px;
            }
            
            .header {
                padding: 32px 24px;
                flex-direction: column;
                text-align: center;
            }
            
            .header-logo {
                position: static;
                transform: none;
                margin-bottom: 16px;
                height: 50px;
            }
            
            .header h1 {
                font-size: 1.6rem;
            }
            
            .form-container {
                padding: 32px 24px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .section {
                padding: 24px 20px;
                margin-bottom: 32px;
            }
            
            .section h3 {
                font-size: 1.2rem;
            }
            
            .form-group {
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .radio-group {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .radio-option {
                padding: 16px;
            }
            
            .submit-btn {
                width: 100%;
                padding: 20px;
                font-size: 1rem;
            }
            
            .footer {
                padding: 24px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.4rem;
            }
            
            .form-container {
                padding: 24px 16px;
            }
            
            .section {
                padding: 20px 16px;
            }
            
            .form-group .question-category {
                font-size: 0.7rem;
                padding: 4px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="https://storage.googleapis.com/opex-web-forms-20250716-145646/opex-logo.avif" alt="Opex Technologies Logo" class="header-logo">
            <div class="header-content">
                <h1>Managed Service Provider Survey</h1>
                <p>Complete capabilities assessment for managed service provider solutions</p>
            </div>
        </div>
        
        <div class="form-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            
            <form id="mspSurveyForm">
                <!-- Contact Information Section -->
                <div class="section contact-section">
                    <h3>Contact Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="contact_name">Full Name *</label>
                            <input type="text" id="contact_name" name="contact_name" required placeholder="Your full name">
                        </div>
                        
                        <div class="form-group">
                            <label for="contact_email">Email Address *</label>
                            <input type="email" id="contact_email" name="contact_email" required placeholder="your@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="contact_company">Company *</label>
                            <input type="text" id="contact_company" name="contact_company" required placeholder="Your company name">
                        </div>
                        
                        <div class="form-group">
                            <label for="contact_phone">Phone Number</label>
                            <input type="tel" id="contact_phone" name="contact_phone" placeholder="(555) 123-4567">
                        </div>
                    </div>
                </div>
                
                <!-- MSP Assessment Questions Section -->
                <div class="section">
                    <h3>Managed Service Provider Assessment Questions</h3>
                    <div id="dynamic-questions">
                        <!-- Questions will be dynamically generated here -->
                    </div>
                </div>
                
                <div class="submit-section">
                    <button type="submit" id="submit-btn" class="submit-btn">Submit Survey</button>
                    <div id="status" class="status"></div>
                </div>
            </form>
        </div>
        
        <div class="footer">
            <p>Managed Service Provider Survey • 
               <a href="mailto:support@example.com">Need assistance?</a></p>
        </div>
    </div>

    <script>
        // MSP questions data (extracted from CSV) - All 208 questions
        const surveyQuestions = [
            {"question": "Company Name", "data_type": "Overview", "input_type": "textarea", "field_id": "field_1"},
            {"question": "Year Founded", "data_type": "Overview", "input_type": "number", "field_id": "field_2"},
            {"question": "Headquarters", "data_type": "Overview", "input_type": "textarea", "field_id": "field_3"},
            {"question": "Ownership", "data_type": "Overview", "input_type": "textarea", "field_id": "field_4"},
            {"question": "Parent Company", "data_type": "Overview", "input_type": "textarea", "field_id": "field_5"},
            {"question": "Number of Clients/Endpoints", "data_type": "Overview", "input_type": "number", "field_id": "field_6"},
            {"question": "Referenceable Clients", "data_type": "Overview", "input_type": "textarea", "field_id": "field_7"},
            {"question": "Number of Employees", "data_type": "Overview", "input_type": "number", "field_id": "field_8"},
            {"question": "Gartner/Forrester/Other Analyst Information", "data_type": "Overview", "input_type": "textarea", "field_id": "field_9"},
            {"question": "Where are you NOCs/SOCs located?", "data_type": "Overview", "input_type": "radio", "field_id": "field_10"},
            {"question": "Do you have a SOC2 Type 2 report that can be shared under NDA?", "data_type": "Overview", "input_type": "radio", "field_id": "field_11"},
            {"question": "List the industry certifications held by your staff.", "data_type": "Overview", "input_type": "textarea", "field_id": "field_12"},
            {"question": "Describe your help desk offering in detail", "data_type": "Help Desk", "input_type": "textarea", "field_id": "field_13"},
            {"question": "How many help desk support personal do you have employed?", "data_type": "Help Desk", "input_type": "number", "field_id": "field_14"},
            {"question": "List the end user applications that you support out of the box.", "data_type": "Help Desk", "input_type": "textarea", "field_id": "field_15"},
            {"question": "What hours is your help desk staffed excluding on call?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_16"},
            {"question": "List your help desk locations.", "data_type": "Help Desk", "input_type": "textarea", "field_id": "field_17"},
            {"question": "List all channels for the client to contact the help desk.", "data_type": "Help Desk", "input_type": "textarea", "field_id": "field_18"},
            {"question": "Can you provide onsite help desk support?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_19"},
            {"question": "Do you staff all support tiers 24/7/365 excluding on-call?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_20"},
            {"question": "Do you provide an on-call service?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_21"},
            {"question": "What reporting do you offer and how frequently?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_22"},
            {"question": "What are your response and resolution SLAs for the help desk?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_23"},
            {"question": "Will you manage customer owned switching, routing, firewalls and wifi networking? What platforms are supported?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_24"},
            {"question": "Do you manage SD-WAN environments? Which platforms do you support/recommend?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_25"},
            {"question": "Do you support/manage LTE circuit devices such as Peplink or Craddlepoint?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_26"},
            {"question": "Do you provide circuit monitoring and support?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_27"},
            {"question": "Do you engage directly with circuit carriers for ticket management, troubleshooting and problem resolution?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_28"},
            {"question": "Do you include onsite support for network hardware issues/replacement?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_29"},
            {"question": "What are your SLA's remote support?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_30"},
            {"question": "What are your SLA's for onsite support if needed? How do you charge for onsite support?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_31"},
            {"question": "Are you willing to provide best effort support on unmanaged/on premise infrastructure (talk LCON through troubleshooting)", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_32"},
            {"question": "If customer chooses to move to a model in the future where you provide the hardware as a monthly service cost, what hardware platforms do you support in this model?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_33"},
            {"question": "What primary monitoring tool does your NOC use for network? Would customer have access to this tool?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_34"},
            {"question": "Do you include proactive capacity and EOL/EOS management as part of your offering?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_35"},
            {"question": "Are you willing to work directly within customers ticketing system?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_36"},
            {"question": "Describe your methodogy for implementing new deployments of LAN/WAN environments (switching, routing, SDWAN, Wifi, cabling etc)", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_37"},
            {"question": "Can you integrate with customers ticketing system for bi-directional ticket mangement?", "data_type": "Managed Infrastructure", "input_type": "textarea", "field_id": "field_38"},
            {"question": "*Compliance", "data_type": "Network Managed Services", "input_type": "textarea", "field_id": "field_39"},
            {"question": "Describe help desk offering(s) in detail.", "data_type": "Network Managed Services", "input_type": "textarea", "field_id": "field_40"},
            {"question": "Do you manage/support end user applications? If so please list supported apps.", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_41"},
            {"question": "What hours are your help desk staffed?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_42"},
            {"question": "What are your help desk locations? Are all staff US based?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_43"},
            {"question": "How can clients access support, ticketing systems, phone, chat, email?", "data_type": "Network Managed Services", "input_type": "textarea", "field_id": "field_44"},
            {"question": "Can you provide onsite support?  Site list to be shared.", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_45"},
            {"question": "Do you offer white-glove/premier help desk services?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_46"},
            {"question": "Do you staff all support tiers 24/7 or do you have to escalate to on call resources during some hours?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_47"},
            {"question": "What reporting do you offer? I.e. Actionanble, Executive.", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_48"},
            {"question": "What are your SLA's for Help Desk?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_49"},
            {"question": "Do you manage desktop/laptop operating systems? List operating systems supported.", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_50"},
            {"question": "What endpoint management tools are leveraged/supported?", "data_type": "Network Managed Services", "input_type": "textarea", "field_id": "field_51"},
            {"question": "Do you manage peripherals (printers, scanners etc.)?", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_52"},
            {"question": "Do you offer hardware/software lifecycle management? If so please describe capabilities.", "data_type": "Network Managed Services", "input_type": "radio", "field_id": "field_53"},
            {"question": "Do you manage on prem/Azure Active Directory?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_54"},
            {"question": "Do you offer onging management of cloud o365 email/apps? Describe services in detail.", "data_type": "Project Work", "input_type": "radio", "field_id": "field_55"},
            {"question": "Do you offer/manage SSO, Identity Mgmt solutions? If so describe in detail.", "data_type": "Project Work", "input_type": "radio", "field_id": "field_56"},
            {"question": "Do you support/manage Sharepoint and MS Teams? Please describe services in detail.", "data_type": "Project Work", "input_type": "radio", "field_id": "field_57"},
            {"question": "Do you offer wharehousing and inventory management of customer devices such as laptop/tablets etc.", "data_type": "Project Work", "input_type": "radio", "field_id": "field_58"},
            {"question": "Do you offer staging/standard imaging and  deployment of end user devices?", "data_type": "AWS", "input_type": "radio", "field_id": "field_59"},
            {"question": "Describe remote support capabilities/methodology. What tools are used?", "data_type": "AWS", "input_type": "textarea", "field_id": "field_60"},
            {"question": "Do you offer managed NAS services? What platforms are supported (Synology?)", "data_type": "AWS", "input_type": "radio", "field_id": "field_61"},
            {"question": "Do you offer patch management? Describe tools used, methodology and supported platforms.", "data_type": "AWS", "input_type": "radio", "field_id": "field_62"},
            {"question": "Do you manage customer owned hardware? Will you engage directly with manufacturer for break-fix/RMA's? List platforms supported.", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_63"},
            {"question": "Do you support/manage voice systems (UCaaS/On Prem Cisco etc.)? List platforms supported.", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_64"},
            {"question": "Do you support managing VMware?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_65"},
            {"question": "Do you support data backup? Servers and endpoints? Please describe.", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_66"},
            {"question": "Do you manage applications? Describe/list applications supported.", "data_type": "Circuit Aggregation", "input_type": "radio", "field_id": "field_67"},
            {"question": "What are your SLA's for hardware/infrastructure/endpoint management?", "data_type": "Circuit Aggregation", "input_type": "radio", "field_id": "field_68"},
            {"question": "What reporting do you offer? I.e. Actionable, Executive.", "data_type": "Circuit Aggregation", "input_type": "radio", "field_id": "field_69"},
            {"question": "Number of clients in the financial vertical", "data_type": "Circuit Aggregation", "input_type": "number", "field_id": "field_70"},
            {"question": "Please list your NOC locations and approximate staffing levels", "data_type": "Circuit Aggregation", "input_type": "textarea", "field_id": "field_71"},
            {"question": "Do you have a SOC2 Type 2 that can be shared under NDA", "data_type": "Circuit Aggregation", "input_type": "radio", "field_id": "field_72"},
            {"question": "Do you include patching in your managed network services?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_73"},
            {"question": "Patching frequency", "data_type": "Project Work", "input_type": "textarea", "field_id": "field_74"},
            {"question": "Is out of schedule emergency patching for critical security patches included?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_75"},
            {"question": "Are major version updates included, or only minor updates?", "data_type": "Project Work", "input_type": "textarea", "field_id": "field_76"},
            {"question": "Can patch schedules be dictated/customized to client needs?", "data_type": "Project Work", "input_type": "textarea", "field_id": "field_77"},
            {"question": "VMware, Server/Desktop OS, Network devices such as firewalls, switches routers? What platform(s) do you use for patching?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_78"},
            {"question": "Do you include onsite support for hardware issues/replacement?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_79"},
            {"question": "Do you coordinate with manufacturers for hardware replacement on bahalf of the customer?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_80"},
            {"question": "What is your SLA for P1 remote support?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_81"},
            {"question": "What is your SLA for onsite support if needed?", "data_type": "Project Work", "input_type": "radio", "field_id": "field_82"},
            {"question": "Do you support Cisco Catalyst and Aironet? What is your Cisco partner level?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_83"},
            {"question": "Do you support Meraki Switching and APs? What is your partner level?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_84"},
            {"question": "Do you support Cato Networks? What is your partner level?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_85"},
            {"question": "If Lighthouse choses to move to a model in the future where you provide the hardware as a monthly service cost, what hardware brands do you support in this model?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_86"},
            {"question": "Can you offer a persistent resource model for a client of this size (not dedicated, but a small number of engineers they would consistenty work with who would know their environment?", "data_type": "Help Desk", "input_type": "number", "field_id": "field_87"},
            {"question": "What primary monitoring tool does your NOC use for network? Would Lighthouse have access to this tool?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_88"},
            {"question": "How many Azure certified engineers/architects do you have on staff?", "data_type": "Help Desk", "input_type": "number", "field_id": "field_89"},
            {"question": "Do you support Azure specific features (autoscaling, RDS, etc.), or just basic infrastructure (VMs, network, storage)", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_90"},
            {"question": "Do you manage the OS?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_91"},
            {"question": "Do you manage applications?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_92"},
            {"question": "Do you provide Microsoft licensing as CSP? Are there advantages to using your services for licensing such as reduced price and/or premier support?", "data_type": "Help Desk", "input_type": "radio", "field_id": "field_93"},
            {"question": "Do you manage M365 suite? If so describe service offering.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_94"},
            {"question": "What is  Microsoft partner Status?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_95"},
            {"question": "Do you have Microsoft Modern Workforce expertise? If so describe.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_96"},
            {"question": "Do you manage desktop/laptop and server operating systems? List operating systems supported.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_97"},
            {"question": "Do you support HPE Alterris SANs? What is your partner level?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_98"},
            {"question": "Do you support HPE Servers? What is your partner level?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_99"},
            {"question": "What are your options for HPE provided hardware replacement (RMA) for failed devices to include HPE resources managing replacement?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_100"},
            {"question": "What endpoint management tools do you use?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_101"},
            {"question": "Do you support/manage virtual infrastructure (VMware etc.)? List supported platforms.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_102"},
            {"question": "Can you support/manage AIX systems?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_103"},
            {"question": "Do you manage/support Microsoft Active Directory and Microsoft EntraID? Describe service offerings.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_104"},
            {"question": "Can you offer co-lo to host 1 rack of infrastructure (AIX, routers, etc.). If so, what locations and what Data Center providers?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_105"},
            {"question": "Do you offer data protection or \"data backup\"? If so describe service offering(s)", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_106"},
            {"question": "Describe reporting available for data backup and DR services.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "textarea", "field_id": "field_107"},
            {"question": "Do you offer customizable data retention?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_108"},
            {"question": "Do you offer both onsite data storage as well as off premise/Cloud based data storage for backup data?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_109"},
            {"question": "Do you support data backup/DR for virtual machines and AIX systems? List supported platforms.", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_110"},
            {"question": "Can clients perform self service restores of data?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "textarea", "field_id": "field_111"},
            {"question": "Can you setup/Manage DR to Azure from our on prem datacenter?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "radio", "field_id": "field_112"},
            {"question": "What RPO's and RTO's are supported for DR?", "data_type": "Infrastructure/Hardware/Endpoint", "input_type": "textarea", "field_id": "field_113"},
            {"question": "Do you provide a DR runbook for both testing and failover events? If so please describe.", "data_type": "Company Information", "input_type": "radio", "field_id": "field_114"},
            {"question": "How many DR tests, per year, are included by default? Can additional tests be added?", "data_type": "Company Information", "input_type": "number", "field_id": "field_115"},
            {"question": "Does your annual BC/DR testing include full production run from the DR site and failback?", "data_type": "Company Information", "input_type": "textarea", "field_id": "field_116"},
            {"question": "How many staff are on the help desk Lighthouse would call into?", "data_type": "Network Manages Services", "input_type": "number", "field_id": "field_117"},
            {"question": "Is the desk staffed 24/7? If so, are all ticket types handled 24/7, or only certain types?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_118"},
            {"question": "SLAs for response", "data_type": "Network Manages Services", "input_type": "textarea", "field_id": "field_119"},
            {"question": "Can you support Jack Henry financial software?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_120"},
            {"question": "Platforms you support \"out of the box\"", "data_type": "Network Manages Services", "input_type": "textarea", "field_id": "field_121"},
            {"question": "Will you support other customer platforms given a runbook or vendor support contract?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_122"},
            {"question": "Can you support a full bi-directional integration with Jira so our employees remain in our system?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_123"},
            {"question": "What voice/UC platforms do you manage/support?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_124"},
            {"question": "Do you offer onging management of cloud o365 email/apps? Describe services in detail.", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_125"},
            {"question": "Do you offer MDR services on Crowdstrike? If not, what platforms do you support?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_126"},
            {"question": "What are your SLAs for response/action for a tool identified issue?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_127"},
            {"question": "Do you perform proactive threat hunting? If so, is there a specific cadence to this?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_128"},
            {"question": "Do you offer vulnerability management? If so, what tool do you use?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_129"},
            {"question": "Does your vulnerability management program include remediation?", "data_type": "Network Manages Services", "input_type": "textarea", "field_id": "field_130"},
            {"question": "Do you offer phishing/cybersecurity awareness training?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_131"},
            {"question": "Do you provide system hardening services?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_132"},
            {"question": "What firewall platforms do you manage/support?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_133"},
            {"question": "Do you manage/support NextGen FW functions such as DLP, Content Filtering, Application Control, IDS/IPS etc.?", "data_type": "Network Manages Services", "input_type": "radio", "field_id": "field_134"},
            {"question": "Will you handle proactive patch management for all PCs, servers, and infrastructure? What tool do you use? Do you offer SLA compliance? Are third party applications included?", "data_type": "Azure/M365", "input_type": "radio", "field_id": "field_135"},
            {"question": "Do you provide an IDP platform (Okta, etc.)", "data_type": "Azure/M366", "input_type": "radio", "field_id": "field_136"},
            {"question": "How would you manage user provisioning/deprovisioning? Do you employ automation such as SCIM or Miscrosoft Autopilot?", "data_type": "Azure/M367", "input_type": "radio", "field_id": "field_137"},
            {"question": "Will you handle PC procurement/turn up/turn down?", "data_type": "Azure/M368", "input_type": "radio", "field_id": "field_138"},
            {"question": "Can you inventory hardware for new employee onboarding?", "data_type": "Azure/M369", "input_type": "radio", "field_id": "field_139"},
            {"question": "Do you manage Intune for end point management, policy enforcement, application control, user managemente etc?", "data_type": "Azure/M370", "input_type": "radio", "field_id": "field_140"},
            {"question": "Do provide OS image management? If so please describe.", "data_type": "Azure/M371", "input_type": "textarea", "field_id": "field_141"},
            {"question": "Will you handle onboarding new applications to the IAM and SSO applications?", "data_type": "Azure/M372", "input_type": "radio", "field_id": "field_142"},
            {"question": "How do you handle hardware lifecycle management?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_143"},
            {"question": "Will you maintain our ITAM DB?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_144"},
            {"question": "Do you manage warranty renewals?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_145"},
            {"question": "Do you handle hardware recycling?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_146"},
            {"question": "Can you provide a certificate of destruction for any decommissioned hardware?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_147"},
            {"question": "If none of your existing carriers can support a site, will you sign a new provider or resell a retail circuit to support client?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_148"},
            {"question": "Do you pass through construction funding from the providing carrier?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_149"},
            {"question": "Do you offer Starlink? If so, are you a direct authorized reseller? If not, whose service are you reselling?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_150"},
            {"question": "Who do you partner with for onsite support? Do they employ W2 technicians or 1099 contractors?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_151"},
            {"question": "Do you support Cradlepoint? What is your partner level?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_152"},
            {"question": "Do you support Meraki APs? What is your partner level?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_153"},
            {"question": "Do you support Fortinet Firewalls? What is your partner level?", "data_type": "Infrastructure Managed Services", "input_type": "radio", "field_id": "field_154"},
            {"question": "Are you willing to provide best effort support on unmanaged (NetGear) switches (talk LCON through troubleshooting)", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_155"},
            {"question": "If Client choses to move to a model in the future where you provide the hardware as a monthly service cost, which hardware brands do you support in this model?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_156"},
            {"question": "Do you offer a branch voice solution (UCaaS)?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_157"},
            {"question": "Can you customise your support model to fit the client preferences? Specifically, can you offer a hybrid model with some persistent resources?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_158"},
            {"question": "What primary monitoring tool does your NOC use for network? Would Client have access to this tool?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_159"},
            {"question": "Are you willing to work directly within the Client's (ZenDesk) ticketing system?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_160"},
            {"question": "Can you integrate with the Client's ticketing system (ZenDesk) for bi-directional ticket mangement?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_161"},
            {"question": "What is your standard support model for a client of this size? (Shared Services, Pod, Fully Dedicated Resources). Please note if this is an elite or higher tier NOC than your smaller clients are supported by.", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_162"},
            {"question": "Do you have a tool to give the Client's visibility and ability to manage their portfolio of connections? What information does this include? Circuit ID? Contract End Date? Costs? Can circuits be added to this tool that you do not procure?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_163"},
            {"question": "How do you track project status during implementations and communicate that with Sun?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_164"},
            {"question": "Is your support fully staffed 24/7 for all incident types? If not, please provide the breakdown.", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_165"},
            {"question": "How late (and in which time zone) can you ship replacement hardware out? How early does an issue need to be identified to ship replacement equipment same day.", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_166"},
            {"question": "Will you provide a consistent implementation team for all installs? Would this include PM and engineer?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_167"},
            {"question": "Will you commit to an executive sponsor for this project? If so, who would that be?", "data_type": "BC/DR", "input_type": "radio", "field_id": "field_168"},
            {"question": "Will your installation techs perform circuit testing during installation based on client guidelines?", "data_type": "Feet on the Street", "input_type": "radio", "field_id": "field_169"},
            {"question": "Please explain your Account Management approach, including how you will structure the account executive and subordinates to fully support the Sun portfolio.  Where will this Account Executive be located?", "data_type": "Feet on the Street", "input_type": "radio", "field_id": "field_170"},
            {"question": "Sun requires quarterly business reviews. Please describe the metrics and agenda that you would typically use to support these meetings.", "data_type": "Feet on the Street", "input_type": "textarea", "field_id": "field_171"},
            {"question": "Please provide a copy of the escalation hierarchy that Customer would currently have access to, from both a NOC and account management perspective, including executive sponsorship.", "data_type": "Feet on the Street", "input_type": "textarea", "field_id": "field_172"},
            {"question": "Would you commit to weekly meetings to discuss project status and update project documentation?", "data_type": "Feet on the Street", "input_type": "textarea", "field_id": "field_173"},
            {"question": "Describe how billing works  assume centralized, nothing sent to site address.  All connections should roll up under one single master account and contact point for billing. Preference is also to bucket services/hardware/onsite seperately. Please confirm if this is possible.", "data_type": "Feet on the Street", "input_type": "radio", "field_id": "field_174"},
            {"question": "If none of your existing carriers can support a site, will you sign a new provider or resell a retail circuit to support QSR?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_175"},
            {"question": "Please provide a broadband circuit procurement process document with ownership groups identified and timelines for each step/task.", "data_type": "Tier 1 Help Desk", "input_type": "textarea", "field_id": "field_176"},
            {"question": "Describe how accounts are setup with the last mile carriers. Will QSRs people be listed as approved contacts?  Who has ownership of the account?", "data_type": "Tier 1 Help Desk", "input_type": "textarea", "field_id": "field_177"},
            {"question": "If ownership is not QSRs, What happens if they leave your services for aggregation?  Can ownership be transferred? If so what is that process?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_178"},
            {"question": "Describe support needs.  QSR Help Desk will be front line for support requests.  Please describe support model as much as possible.", "data_type": "Tier 1 Help Desk", "input_type": "textarea", "field_id": "field_179"},
            {"question": "Do you have a tool to give QSR visibility and ability to manage their portfolio of connections?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_180"},
            {"question": "Will your installation techs perform circuit testing during installation based on QSR guidelines?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_181"},
            {"question": "Please explain your Account Management approach, including how you will structure the account executive and subordinates to fully support the QSR portfolio.  Where will this Account Executive be located?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_182"},
            {"question": "QSR requires quarterly business reviews. Please describe the metrics and agenda that you would typically use to support these meetings.", "data_type": "Tier 1 Help Desk", "input_type": "textarea", "field_id": "field_183"},
            {"question": "Describe how billing works  assume centralized, nothing sent to restaurant address.  All connections should roll up under one single master account and contact point for billing. Please confirm if this is possible.", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_184"},
            {"question": "If Customer choses to move to a model in the future where you provide the hardware as a monthly service cost, which hardware brands do you support in this model?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_185"},
            {"question": "Are you willing to work directly within Customer's (ZenDesk) ticketing system?", "data_type": "Tier 1 Help Desk", "input_type": "radio", "field_id": "field_186"},
            {"question": "Can you integrate with Customer's ticketing system (ZenDesk) for bi-directional ticket mangement?", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_187"},
            {"question": "Do you have a tool to give Customer visibility and ability to manage their portfolio of connections? What information does this include? Circuit ID? Contract End Date? Costs? Can circuits be added to this tool that you do not procure?", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_188"},
            {"question": "Do you offer circuit procurement", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_189"},
            {"question": "Do you hold direct contracts with the circuit providers, or do you leverage an aggregator?", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_190"},
            {"question": "Do you offer circuit management", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_191"},
            {"question": "Do you actively monitor and proactively open tickets for circuit issues", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_192"},
            {"question": "Is onsite hardware replacement included", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_193"},
            {"question": "What is your SLA for onsite replacement", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_194"},
            {"question": "What is your SLA for P1 incident response", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_195"},
            {"question": "Do you provide an uptime SLA if both hardware and circuits are procured through you? What is the SLA?", "data_type": "InfoSec", "input_type": "radio", "field_id": "field_196"},
            {"question": "Do you provide client access to the SD-WAN portal (co-management)", "data_type": "User provisioning/IDP", "input_type": "radio", "field_id": "field_197"},
            {"question": "Original to platform, built later, or acquired", "data_type": "User provisioning/IDP", "input_type": "textarea", "field_id": "field_198"},
            {"question": "Traffic Handling (packet or session)", "data_type": "User provisioning/IDP", "input_type": "textarea", "field_id": "field_199"},
            {"question": "Can you shift traffic mid-session", "data_type": "User provisioning/IDP", "input_type": "radio", "field_id": "field_200"},
            {"question": "Throughput monitoring", "data_type": "User provisioning/IDP", "input_type": "textarea", "field_id": "field_201"},
            {"question": "Cloud Optimization", "data_type": "User provisioning/IDP", "input_type": "textarea", "field_id": "field_202"},
            {"question": "Do you support full mesh? If so, what is the maximum number of sites in a full mesh?", "data_type": "User provisioning/IDP", "input_type": "number", "field_id": "field_203"},
            {"question": "How do you connect into Azure?", "data_type": "Asset lifecycle management", "input_type": "radio", "field_id": "field_204"},
            {"question": "Do you support wireless as a path of last resort?", "data_type": "Asset lifecycle management", "input_type": "radio", "field_id": "field_205"},
            {"question": "How do you license HA?", "data_type": "Asset lifecycle management", "input_type": "radio", "field_id": "field_206"},
            {"question": "Optimize traffic to", "data_type": "Asset lifecycle management", "input_type": "textarea", "field_id": "field_207"},
            {"question": "O365/Teams", "data_type": "Asset lifecycle management", "input_type": "textarea", "field_id": "field_208"}
        ];

        function generateQuestions() {
            const container = document.getElementById('dynamic-questions');
            
            surveyQuestions.forEach((q, index) => {
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                // Use question text as field name (sanitized for HTML form names)
                const fieldName = q.question.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase();
                
                let inputElement = '';
                
                // Generate input based on specified input_type
                switch(q.input_type) {
                    case 'radio':
                        inputElement = `
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="${fieldName}" value="yes" id="${fieldName}_yes">
                                    <span class="radio-label">Yes</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="${fieldName}" value="no" id="${fieldName}_no">
                                    <span class="radio-label">No</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="${fieldName}" value="partial" id="${fieldName}_partial">
                                    <span class="radio-label">Partial/Limited</span>
                                </label>
                            </div>
                        `;
                        break;
                    case 'number':
                        inputElement = `<input type="number" id="${fieldName}" name="${fieldName}" placeholder="Enter number">`;
                        break;
                    case 'text':
                        inputElement = `<input type="text" id="${fieldName}" name="${fieldName}" placeholder="Enter text">`;
                        break;
                    case 'textarea':
                    default:
                        inputElement = `<textarea id="${fieldName}" name="${fieldName}" placeholder="Please provide details..."></textarea>`;
                        break;
                }
                
                formGroup.innerHTML = `
                    <label for="${fieldName}">
                        <span class="question-category">${q.data_type}</span><br>
                        ${q.question}
                    </label>
                    ${inputElement}
                `;
                
                container.appendChild(formGroup);
            });
        }

        function updateProgress() {
            const form = document.getElementById('mspSurveyForm');
            let filled = 0;
            let totalQuestions = 0;
            
            // Count contact fields
            const contactInputs = form.querySelectorAll('.contact-section input[required]');
            contactInputs.forEach(input => {
                totalQuestions++;
                if (input.value.trim() !== '') {
                    filled++;
                }
            });
            
            // Count survey questions
            surveyQuestions.forEach(q => {
                totalQuestions++;
                const fieldName = q.question.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase();
                if (q.input_type === 'radio') {
                    // Check if any radio button in this group is selected
                    const radioChecked = form.querySelector(`input[name="${fieldName}"]:checked`);
                    if (radioChecked) {
                        filled++;
                    }
                } else {
                    // Check text/textarea/number inputs
                    const input = form.querySelector(`#${fieldName}`);
                    if (input && input.value.trim() !== '') {
                        filled++;
                    }
                }
            });
            
            const percentage = totalQuestions > 0 ? (filled / totalQuestions) * 100 : 0;
            document.getElementById('progress-fill').style.width = percentage + '%';
        }

        document.addEventListener('DOMContentLoaded', function() {
            generateQuestions();
            
            // Add event listeners for progress tracking
            const form = document.getElementById('mspSurveyForm');
            form.addEventListener('input', updateProgress);
            form.addEventListener('change', updateProgress);
            
            // Form submission
            document.getElementById('mspSurveyForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const submitBtn = document.getElementById('submit-btn');
                const statusDiv = document.getElementById('status');
                const webhookUrl = 'https://opex-form-webhook-4jypryamoq-uc.a.run.app';
                
                // Disable button and show loading
                submitBtn.disabled = true;
                submitBtn.textContent = 'Submitting...';
                statusDiv.style.display = 'none';
                
                // Collect form data
                const formData = new FormData(this);
                const data = {
                    formName: 'managed-service-provider-survey',
                    formData: {
                        timestamp: new Date().toISOString(),
                        source: 'msp-capabilities-survey'
                    }
                };
                
                // Add all form fields to data
                for (let [key, value] of formData.entries()) {
                    data.formData[key] = value;
                }
                
                try {
                    const response = await fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    if (response.ok) {
                        statusDiv.className = 'status success';
                        statusDiv.textContent = 'Survey submitted successfully! Thank you for your responses.';
                        statusDiv.style.display = 'block';
                        
                        // Reset form
                        this.reset();
                        updateProgress();
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                } catch (error) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `Error submitting survey: ${error.message}`;
                    statusDiv.style.display = 'block';
                }
                
                // Re-enable button
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Survey';
            });
        });
    </script>
</body>
</html>